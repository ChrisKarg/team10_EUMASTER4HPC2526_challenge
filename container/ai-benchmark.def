Bootstrap: docker
From: ubuntu:22.04

%environment
    export PYTHONPATH=/usr/local/lib/python3.10/site-packages:$PYTHONPATH
    export PATH=/usr/local/bin:$PATH

%post
    apt-get update && apt-get install -y \
        python3 python3-pip python3-venv git wget curl build-essential

    pip3 install --upgrade pip
    pip3 install numpy pandas torch torchvision tensorflow dask matplotlib prometheus_client

    # Copy benchmarks into container
    mkdir -p /opt/benchmarks
    cp -r /benchmarks/* /opt/benchmarks/

%runscript
    echo "Welcome to AI Benchmark Container!"
    echo "Available commands: run_inference, run_gpu, run_ollama"

    case "$1" in
        run_inference)
            python3 /opt/benchmarks/run_inference.py
            ;;
        run_gpu)
            python3 /opt/benchmarks/gpu_benchmark.py
            ;;
        run_ollama)
            python3 /opt/benchmarks/ollama_benchmark.py
            ;;
        *)
            exec "$@"
            ;;
    esac
